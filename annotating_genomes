##
#These are just a few bits and bobs that I find really useful when starting a comparative genomics project. Maybe you will find it useful! 
#(and maybe I will learn to keep my scripts organised...)


##
#Filtering a genome is really important to maintain good data, and filter out all the small contigs that are very likely uninformative
#For this, I wrote a small QUAST-like R script (QC_For_R.rmd in the parent folder), but you can, of course just use QUAST as it is currently more informative
python2 /quast-4.6.2/quast.py INPUT_FASTA1.fasta INPUT_FASTA2.fasta -o INPUT_RAW

#After this, I see how much of the genome is represented at certain contig lengths, and then I use remove.smalls.pl to filter out small contigs. 
#I generally filter anything under 10kb out. Of course, I may lose some data, but I also lose a lot of noise.

##
#First, the genome must be annotated. For this, I really like Augustus (https://github.com/Gaius-Augustus/Augustus). It has nice training models, and lots of nifty tools
#Since I am currently working with Cercospora species, I use magnaporthe_grisea as a training model.
#Here is just a simple little bash line for this:

for f1 in /your/directory/*.fasta
do
augustus --species=magnaporthe_grisea ${f1} --gff3=on --stopCodonExcludedFromCDS=false --genemodel=complete > ${f1}.gff
done

##
#To get the CDS and protein sequences from the resulting GFF, Augustus has a nice little perl script called getAnno

perl /Augustus/scripts/getAnnoFasta.pl GFF_FROM_ABOVE.gff --seqfile=FASTA_FROM_ABOVE.fasta

##
#To annotate secondary metabolite clusters, I like using the fungal version of antiSMASH2 (https://fungismash.secondarymetabolites.org/#!/start)
#I prefer the web interface (because I don't have too many genomes)

##
#To find proteins that have signal peptides and are potentially effectors, I use SignalP and EffectorP
